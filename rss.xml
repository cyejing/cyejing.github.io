<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
      <title>Cyejing</title>
      <link>https://cyejing.cn</link>
      <description>Cyejing blog</description>
      <generator>Zola</generator>
      <language>en</language>
      <atom:link href="https://cyejing.cn/rss.xml" rel="self" type="application/rss+xml"/>
      <lastBuildDate>Sat, 15 Apr 2023 00:00:00 +0000</lastBuildDate>
      <item>
          <title>Github-Webhook自动部署到服务器</title>
          <pubDate>Sat, 15 Apr 2023 00:00:00 +0000</pubDate>
          <author>Unknown</author>
          <link>https://cyejing.cn/posts/github-webhookzi-dong-bu-shu-dao-fu-wu-qi/</link>
          <guid>https://cyejing.cn/posts/github-webhookzi-dong-bu-shu-dao-fu-wu-qi/</guid>
          <description>&lt;h3 id=&quot;qi-yin&quot;&gt;起因&lt;&#x2F;h3&gt;
&lt;p&gt;Github Page 虽然好用，但是国内访问速度总是缓慢。&lt;&#x2F;p&gt;
&lt;p&gt;于是打算和github action配合把构建好的静态页面部署到服务器nginx。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;pei-zhi&quot;&gt;配置&lt;&#x2F;h3&gt;
&lt;h4 id=&quot;pei-zhi-github&quot;&gt;配置github&lt;&#x2F;h4&gt;
&lt;p&gt;github 项目配置页面设置webhook地址。&lt;&#x2F;p&gt;
&lt;p&gt;可以选择在只有push事件的时候触发webhook&lt;&#x2F;p&gt;
&lt;h4 id=&quot;pei-zhi-fu-wu-qi&quot;&gt;配置服务器&lt;&#x2F;h4&gt;
&lt;p&gt;我采用这个rust写web服务 &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;cyejing&#x2F;github-webhook-server&quot;&gt;源码地址&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;通过配置文件，可以暴露出web接口。&lt;&#x2F;p&gt;
&lt;p&gt;当webhook触发，会对比触发的项目和配置的项目，以及配置的事件类型。&lt;&#x2F;p&gt;
&lt;p&gt;当匹配成功会在&lt;code&gt;repo_directory&lt;&#x2F;code&gt;目录执行git更新，并且在&lt;code&gt;working_directory&lt;&#x2F;code&gt;执行&lt;code&gt;command&lt;&#x2F;code&gt;。&lt;&#x2F;p&gt;
&lt;h4 id=&quot;pei-zhi-nginx&quot;&gt;配置nginx&lt;&#x2F;h4&gt;
&lt;p&gt;nginx配置映射&lt;code&gt;repo_directory&lt;&#x2F;code&gt;目录的静态文件。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;zong-jie&quot;&gt;总结&lt;&#x2F;h3&gt;
&lt;p&gt;整个流程如下：&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;当提交代码时会触发github-aciton, 并且构建出静态页面推送到&lt;code&gt;gh-pages&lt;&#x2F;code&gt;分支。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;当&lt;code&gt;gh-pages&lt;&#x2F;code&gt;分支受到推送事件会触发webhook到服务器。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;服务器执行git更新，静态页面服务nginx得到更新&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</description>
      </item>
      <item>
          <title>Hello</title>
          <pubDate>Sun, 09 Apr 2023 00:00:00 +0000</pubDate>
          <author>Unknown</author>
          <link>https://cyejing.cn/posts/hello/</link>
          <guid>https://cyejing.cn/posts/hello/</guid>
          <description>&lt;h3 id=&quot;bo-ke-chu-shi-hua&quot;&gt;博客初始化&lt;&#x2F;h3&gt;
&lt;p&gt;博客刚刚搭建完毕，虽然我不怎么爱写博客，留着占个位吧。&lt;&#x2F;p&gt;
&lt;h3 id=&quot;bo-ke-gong-ju&quot;&gt;博客工具&lt;&#x2F;h3&gt;
&lt;p&gt;采用Rust 编写的Zola工具 生成静态模板。&lt;&#x2F;p&gt;
&lt;p&gt;基于Hermit_Zola主题，样式做了一些改动&lt;&#x2F;p&gt;
&lt;h3 id=&quot;zhi-xie&quot;&gt;致谢&lt;&#x2F;h3&gt;
&lt;p&gt;感谢我的妻子和可爱的女儿&lt;&#x2F;p&gt;
</description>
      </item>
    </channel>
</rss>
